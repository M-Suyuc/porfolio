---
import { FolderCode, Mail, User } from 'lucide-react'
import { DrawerDemo } from './render-Drawer'

const pages = [
	{ label: 'Projects', href: '#projects', icon: FolderCode },
	{ label: 'About', href: '#about', icon: User },
	{ label: 'Contact', href: '#contact', icon: Mail }
].map((page) => ({
	...page,
	active: Astro.url.pathname === page.href
}))
---

<header class="fixed top-0 z-50 mx-auto hidden h-16 w-full text-center sm:flex lg:h-20">
	<nav
		class="xs:px-6 h-h-full mx-auto flex w-full max-w-6xl items-center justify-between px-4 sm:px-8 lg:px-0"
	>
		<div class="flex items-center gap-10">
			{
				pages.map(({ label, href, active, icon: Icon }) => (
					<a
						href={href}
						class:list={[
							'hover:text-foreground/80 flex cursor-pointer items-center gap-[6px] font-medium',
							{ 'text-foreground/95': !active },
							{ 'text-red-800': active }
						]}
					>
						<Icon className="size-[18px]" />
						{label}
					</a>
				))
			}
		</div>
	</nav>
</header>

<header class="px-4 py-2 sm:hidden">
	<DrawerDemo client:load />
</header>

<style>
	header {
		animation: header-blur-scroll linear both;
		animation-timeline: scroll();
		animation-range: 0 250px;
	}
	@keyframes header-blur-scroll {
		to {
			background: black;
		}
	}

	nav a.active {
		color: gray;
	}
</style>

<script>
	let secctions = document.querySelectorAll('section')
	const links = document.querySelectorAll('nav a')
	window.onscroll = () => {
		secctions.forEach((sec) => {
			let top = window.scrollY
			let offset = sec.offsetTop
			let height = sec.offsetHeight
			let id = sec.getAttribute('id')
			if (top >= offset && top < offset + height) {
				links.forEach((link) => {
					link.classList.remove('active')
					document.querySelector('a[href*=' + id + ']')?.classList.add('active')
				})
			}
		})
	}
</script>
